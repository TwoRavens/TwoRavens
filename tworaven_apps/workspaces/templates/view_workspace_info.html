{% extends 'base.html' %}
{% load humanize %}

{% block title_block %}Session Info{% endblock %}

{% block main_content %}
<div class="row">
  <div class="col-12 col-md-8">
    <h3>TwoRavens Session Info (test)</h3>

    <p><b>session_key</b>: {{ session_key }}</p>
    {% if not current_workspace %}
    <div class="alert alert-warning" role="alert">
      Sorry, no current workspace to show.
    </div>
    {% else %}
    <div class="alert alert-success" role="alert">
        <h4>workspace found!</h4>
      <p>
        <b>name</b>: {{ current_workspace.name }}<br />
        <b>domain</b>: {{ current_workspace.domain }}<br />
        <b>user</b>: {{ current_workspace.user }}<br />
        <b>modified</b>: {{ current_workspace.modified }}<br />

      <p>Click on a key name to view data.</p>
    </div>
    <div>
      <!--p><a href="{% url 'clear_user_metadata' %}">clear user session data</a></p-->
    {% endif %}

    <div id="accordion" role="tablist">
        {% if current_workspace.zparams %}
          {% with json_var=current_workspace.zparams var_name='zparams' %}
            {% include 'json_var_card.html' %}
          {% endwith %}
        {% endif %}
        {% if current_workspace.zparams %}
          {% with json_var=current_workspace.allnodes var_name='allnodes' %}
            {% include 'json_var_card.html' %}
          {% endwith %}
        {% endif %}
    </div>
    {% comment %}
    {% for info in [current_workspace, ] %}
      {% if session_info %}
        <div class="card">
          <div class="card-header" role="tab" id="heading{{ forloop.counter }}">({{ forloop.counter }})
            <a data-toggle="collapse" href="#collapse{{ forloop.counter }}" aria-expanded="false" aria-controls="collaps{{ forloop.counter }}">
              <b>{{ session_info.session_key }}</b></a>
              {% if session_info.data_size %}
              &nbsp; &nbsp; data size: {{ session_info.data_size|intcomma }}
              {% endif %}
          </div>

          <div id="collapse{{ forloop.counter }}" class="collapse" role="tabpanel" aria-labelledby="heading{{ forloop.counter }}" data-parent="#accordion">
            <div class="card-body">
              {% if session_info.is_data_formatted %}
              <pre><code>{{ session_info.get_display_data }}</code></pre>
              {% else %}
              {{ session_info.get_display_data }}
              {% endif %}
            </div>
          </div>
        </div>
        <br />
      {% endif %}
    {% endfor %}
    {% endcomment %}

</div>

  </div>
</div>
{% endblock %}
