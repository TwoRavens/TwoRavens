
{
	"$group": {
		"_id": {
			"date": {"$dateToString": {"format": "%Y-%m", "date": "$story_date_constructed"}},
			"link1": {"$and": [{"$not": {"$in": ["$source", ["AFG", "MUS"]]}}]},
			"link2": {"$and": [{"$not": {"$in": ["$target", ["AFG", "MUS"]]}}]}
		},
		"03": {"$sum": {"$cond": [
			{"$eq": ["$rootCode", "03"]}, 
			1, 
			0]}},
		"04": {"$sum": {"$cond": [
			{"$anyElementTrue": { "$map": {"input": [ "040","041","042","043","044","045"],"as": "el","in": { "$eq": ["$$el", "$code"]}}}},
            1,
            0]}},
		"05": {"$sum": {"$cond": [
			{"$eq": ["$rootCode", "05"]}, 
			1, 
			0]}}
	}
}
